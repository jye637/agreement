<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>資安同意書管理後台</title>

<!-- 使用 Google Fonts 避免中文亂碼 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Noto Sans TC', sans-serif;
  background: #f0f2f5;
  padding: 20px;
  margin: 0;
}
.container {
  max-width: 900px;
  margin: 0 auto;
  background: #fff;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
.title {
  text-align: center;
  font-size: 28px;
  font-weight: 700;
  color: #006600;
}
.signature-block {
  border: 1px solid #ddd;
  padding: 20px;
  border-radius: 12px;
  margin-top: 25px;
}
.signature-block img {
  max-width: 300px;
  display: block;
  margin-top: 10px;
}
.print-btn {
  padding: 10px 18px;
  margin-top: 20px;
  background: #006600;
  color: #fff;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
}
.print-btn:hover {
  background: #008000;
}
</style>
</head>

<body>
<div class="container">
  <h1 class="title">蔡文國民小學 資通安全保密同意書（管理後台）</h1>

  <p>
    以下為所有教職員簽署的資通安全保密同意書資料，包括：<br>
    1. 身分證後五碼<br>
    2. 簽名圖片<br>
    3. 簽署時間<br>
  </p>

  <button class="print-btn" onclick="window.print()">列印 / 另存 PDF</button>

  <div id="result"></div>
</div>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

/* ⚠️ 請在此貼上你的 Firebase 設定 */
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCk-1B0IwsSOwlNIn71-LofJRoHzgh6kJQ",
  authDomain: "signup-f163b.firebaseapp.com",
  projectId: "signup-f163b",
  storageBucket: "signup-f163b.firebasestorage.app",
  messagingSenderId: "4965735888",
  appId: "1:4965735888:web:6ce33434885f967ed22dd5",
  measurementId: "G-81931LXRL1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadData() {
  const container = document.getElementById("result");
  const querySnap = await getDocs(collection(db, "signatures"));

  querySnap.forEach(doc => {
    const data = doc.data();

    const block = document.createElement("div");
    block.className = "signature-block";

    block.innerHTML = `
      <h3>使用者：${data.idLast5}</h3>

      <p><strong>簽署時間：</strong>${data.timestamp || "未紀錄"}</p>

      <p><strong>使用者簽名：</strong></p>
      <img src="${data.signatureDataUrl}" alt="User Signature">

      <hr>

      <p><strong>使用者同意的條款：</strong></p>
      <ol>
        <li>於業務上所知悉之機敏資料及運用之資通系統等，應善盡保管及保密之責。</li>
        <li>不得私自洩漏與業務無關之人員。</li>
        <li>使用即時通訊軟體時，不得涉及機密資料。</li>
        <li>遵守本單位資通安全相關法令與規定。</li>
        <li>如有危害本單位資通安全之行為，願負相關責任。</li>
      </ol>
    `;

    container.appendChild(block);
  });
}

loadData();
</script>

</body>
</html>
