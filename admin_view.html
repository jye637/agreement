<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>è³‡å®‰æ¢æ¬¾ç°½ç½²å¾Œå°</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #999;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #eee;
        }
        img.signature {
            width: 250px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

<h2>è³‡å®‰æ¢æ¬¾ç°½ç½²å¾Œå°</h2>
<p>ä»¥ä¸‹ç‚ºæ‰€æœ‰ä½¿ç”¨è€…çš„åŒæ„ç‹€æ³ã€ç°½åèˆ‡æ™‚é–“ç´€éŒ„ï¼š</p>

<table>
    <thead>
        <tr>
            <th>å§“å userName</th>
            <th>èº«åˆ†è­‰æœ«äº”ç¢¼ idLast5</th>
            <th>æ˜¯å¦åŒæ„ agree</th>
            <th>ç°½å signature</th>
            <th>æ™‚é–“ timestamp</th>
        </tr>
    </thead>
    <tbody id="data-body"></tbody>
</table>

<!-- ğŸ”¥ æ­£ç¢ºè¼‰å…¥ Firebase v8ï¼ˆä½ ä¹‹å‰éŒ¯åœ¨è¼‰å…¥ v10ï¼‰ -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script>
    // â­ å¡«å…¥ä½ çš„ Firebase è¨­å®šï¼ˆèˆ‡å‰å°ç›¸åŒï¼‰
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCk-1B0IwsSOwlNIn71-LofJRoHzgh6kJQ",
  authDomain: "signup-f163b.firebaseapp.com",
  projectId: "signup-f163b",
  storageBucket: "signup-f163b.firebasestorage.app",
  messagingSenderId: "4965735888",
  appId: "1:4965735888:web:6ce33434885f967ed22dd5",
  measurementId: "G-81931LXRL1"
};

    // åˆå§‹åŒ– Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // è®€å– signatures é›†åˆä¸¦é¡¯ç¤ºåœ¨è¡¨æ ¼
    function loadData() {
        const tbody = document.getElementById("data-body");
        tbody.innerHTML = "";

        db.collection("signatures").orderBy("timestamp", "desc").get()
            .then(snapshot => {
                snapshot.forEach(doc => {
                    const d = doc.data();

                    const row = `
                        <tr>
                            <td>${d.userName || "æœªå¡«"}</td>
                            <td>${d.idLast5 || "æœªå¡«"}</td>
                            <td>${d.agree ? "âœ” å·²åŒæ„" : "âœ˜ æœªåŒæ„"}</td>
                            <td>
                                ${d.signatureDataUrl 
                                    ? `<img src="${d.signatureDataUrl}" class="signature">` 
                                    : "æœªç°½å"}
                            </td>
                            <td>${d.timestamp || "æœªè¨˜éŒ„"}</td>
                        </tr>
                    `;

                    tbody.innerHTML += row;
                });
            })
            .catch(err => {
                console.error("è®€å–å¤±æ•—ï¼š", err);
                alert("ç„¡æ³•è®€å–è³‡æ–™ï¼Œè«‹æª¢æŸ¥ Firebase è¨­å®šï¼");
            });
    }

    // è¼‰å…¥è³‡æ–™
    loadData();
</script>

</body>
</html>
